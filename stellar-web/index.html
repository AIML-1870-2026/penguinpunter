<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stellar Web - Firework Show</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #000;
            overflow: hidden;
            color: #fff;
        }

        #canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: block;
        }

        .controls {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 100;
            width: 240px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
            padding-right: 10px;
        }

        .controls::-webkit-scrollbar {
            width: 4px;
        }

        .controls::-webkit-scrollbar-thumb {
            background: #e8a44a;
            border-radius: 2px;
        }

        .section-title {
            font-size: 11px;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
            margin-top: 20px;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
        }

        .section-title:first-child {
            margin-top: 0;
        }

        .control-group {
            margin-bottom: 18px;
        }

        .control-group label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            color: #e8a44a;
            margin-bottom: 8px;
        }

        .control-group input[type="range"] {
            width: 100%;
            height: 5px;
            border-radius: 3px;
            background: #4a4a4a;
            -webkit-appearance: none;
            appearance: none;
            cursor: pointer;
        }

        .control-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #e8a44a;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 15px;
        }

        .theme-btn {
            padding: 5px 10px;
            border: 1px solid #e8a44a;
            background: transparent;
            color: #e8a44a;
            border-radius: 4px;
            cursor: pointer;
            font-size: 10px;
            transition: all 0.2s;
        }

        .theme-btn:hover {
            background: rgba(232, 164, 74, 0.2);
        }

        .theme-btn.active {
            background: #e8a44a;
            color: #000;
        }

        .toggle-group {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .toggle-group label {
            font-size: 13px;
            color: #e8a44a;
        }

        .toggle {
            position: relative;
            width: 40px;
            height: 20px;
        }

        .toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #4a4a4a;
            transition: 0.3s;
            border-radius: 20px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 14px;
            width: 14px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        .toggle input:checked + .toggle-slider {
            background-color: #e8a44a;
        }

        .toggle input:checked + .toggle-slider:before {
            transform: translateX(20px);
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <div class="controls">
        <div class="section-title">Fireworks</div>
        <div class="control-group">
            <label>Launch Rate</label>
            <input type="range" id="launchRate" min="1" max="20" value="8">
        </div>
        <div class="control-group">
            <label>Explosion Size</label>
            <input type="range" id="explosionSize" min="20" max="100" value="50">
        </div>
        <div class="control-group">
            <label>Spark Count</label>
            <input type="range" id="sparkCount" min="20" max="150" value="60">
        </div>
        <div class="control-group">
            <label>Trail Length</label>
            <input type="range" id="trailLength" min="5" max="30" value="15">
        </div>

        <div class="section-title">Visual Effects</div>
        <div class="toggle-group">
            <label>Shooting Stars</label>
            <label class="toggle">
                <input type="checkbox" id="shootingStars" checked>
                <span class="toggle-slider"></span>
            </label>
        </div>
        <div class="toggle-group">
            <label>Multi-burst</label>
            <label class="toggle">
                <input type="checkbox" id="multiBurst" checked>
                <span class="toggle-slider"></span>
            </label>
        </div>
        <div class="toggle-group">
            <label>Sparkle Trail</label>
            <label class="toggle">
                <input type="checkbox" id="sparkleTrail" checked>
                <span class="toggle-slider"></span>
            </label>
        </div>

        <div class="section-title">Color Theme</div>
        <div class="button-group">
            <button class="theme-btn active" data-theme="rainbow">Rainbow</button>
            <button class="theme-btn" data-theme="ocean">Ocean</button>
            <button class="theme-btn" data-theme="fire">Fire</button>
            <button class="theme-btn" data-theme="pastel">Pastel</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Settings
        let settings = {
            launchRate: 8,
            explosionSize: 50,
            sparkCount: 60,
            trailLength: 15,
            shootingStars: true,
            multiBurst: true,
            sparkleTrail: true,
            colorTheme: 'rainbow'
        };

        // Color themes
        const colorThemes = {
            rainbow: [
                { r: 255, g: 0, b: 100 },
                { r: 255, g: 50, b: 50 },
                { r: 255, g: 150, b: 0 },
                { r: 255, g: 255, b: 0 },
                { r: 0, g: 255, b: 100 },
                { r: 0, g: 255, b: 255 },
                { r: 100, g: 100, b: 255 },
                { r: 200, g: 0, b: 255 },
                { r: 255, g: 0, b: 255 },
            ],
            ocean: [
                { r: 0, g: 100, b: 150 },
                { r: 0, g: 150, b: 200 },
                { r: 0, g: 200, b: 255 },
                { r: 100, g: 220, b: 255 },
                { r: 0, g: 255, b: 200 },
                { r: 50, g: 150, b: 180 },
            ],
            fire: [
                { r: 255, g: 50, b: 0 },
                { r: 255, g: 100, b: 0 },
                { r: 255, g: 150, b: 0 },
                { r: 255, g: 200, b: 50 },
                { r: 255, g: 255, b: 100 },
                { r: 200, g: 50, b: 0 },
            ],
            pastel: [
                { r: 255, g: 182, b: 193 },
                { r: 255, g: 218, b: 185 },
                { r: 255, g: 255, b: 186 },
                { r: 186, g: 255, b: 201 },
                { r: 186, g: 225, b: 255 },
                { r: 221, g: 186, b: 255 },
            ]
        };

        function getColors() {
            return colorThemes[settings.colorTheme];
        }

        function getRandomColor() {
            const colors = getColors();
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // Launching firework rocket
        class Rocket {
            constructor(x) {
                this.x = x || Math.random() * canvas.width;
                this.y = canvas.height;
                this.targetY = canvas.height * (0.15 + Math.random() * 0.4);
                this.vy = -(8 + Math.random() * 4);
                this.vx = (Math.random() - 0.5) * 2;
                this.color = getRandomColor();
                this.trail = [];
                this.exploded = false;
                this.size = 3;
            }

            update() {
                // Add to trail
                if (settings.sparkleTrail) {
                    this.trail.push({
                        x: this.x,
                        y: this.y,
                        life: 1.0,
                        vx: (Math.random() - 0.5) * 0.5,
                        vy: Math.random() * 0.5
                    });
                    if (this.trail.length > settings.trailLength) {
                        this.trail.shift();
                    }
                }

                // Update trail particles
                this.trail.forEach(t => {
                    t.x += t.vx;
                    t.y += t.vy;
                    t.life -= 0.05;
                });
                this.trail = this.trail.filter(t => t.life > 0);

                // Move rocket
                this.x += this.vx;
                this.y += this.vy;
                this.vy += 0.05; // Slow down as it rises

                // Check if should explode
                if (this.y <= this.targetY || this.vy >= 0) {
                    this.exploded = true;
                }
            }

            draw() {
                const c = this.color;

                // Draw trail
                this.trail.forEach((t, i) => {
                    const alpha = t.life * 0.8;
                    const size = t.life * 2;

                    ctx.beginPath();
                    ctx.arc(t.x, t.y, size, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(${c.r}, ${c.g}, ${c.b}, ${alpha})`;
                    ctx.fill();
                });

                // Draw rocket head
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, 1)`;
                ctx.fill();

                // Glow
                const gradient = ctx.createRadialGradient(
                    this.x, this.y, 0,
                    this.x, this.y, this.size * 4
                );
                gradient.addColorStop(0, `rgba(${c.r}, ${c.g}, ${c.b}, 0.8)`);
                gradient.addColorStop(1, `rgba(${c.r}, ${c.g}, ${c.b}, 0)`);
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size * 4, 0, Math.PI * 2);
                ctx.fillStyle = gradient;
                ctx.fill();
            }
        }

        // Explosion spark
        class Spark {
            constructor(x, y, color, speed) {
                this.x = x;
                this.y = y;
                const angle = Math.random() * Math.PI * 2;
                const spd = speed * (0.5 + Math.random() * 0.5);
                this.vx = Math.cos(angle) * spd;
                this.vy = Math.sin(angle) * spd;
                this.color = color;
                this.life = 1.0;
                this.decay = 0.01 + Math.random() * 0.015;
                this.size = 1.5 + Math.random() * 2;
                this.trail = [];
            }

            update() {
                // Trail
                this.trail.push({ x: this.x, y: this.y, life: 0.5 });
                if (this.trail.length > 8) this.trail.shift();
                this.trail.forEach(t => t.life -= 0.08);
                this.trail = this.trail.filter(t => t.life > 0);

                this.x += this.vx;
                this.y += this.vy;
                this.vy += 0.08; // Gravity
                this.vx *= 0.98;
                this.vy *= 0.98;
                this.life -= this.decay;
            }

            draw() {
                const c = this.color;
                const alpha = this.life;

                // Trail
                this.trail.forEach(t => {
                    ctx.beginPath();
                    ctx.arc(t.x, t.y, this.size * 0.5 * t.life, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(${c.r}, ${c.g}, ${c.b}, ${t.life * alpha * 0.5})`;
                    ctx.fill();
                });

                // Glow
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size * 3, 0, Math.PI * 2);
                const gradient = ctx.createRadialGradient(
                    this.x, this.y, 0,
                    this.x, this.y, this.size * 3
                );
                gradient.addColorStop(0, `rgba(${c.r}, ${c.g}, ${c.b}, ${alpha * 0.8})`);
                gradient.addColorStop(1, `rgba(${c.r}, ${c.g}, ${c.b}, 0)`);
                ctx.fillStyle = gradient;
                ctx.fill();

                // Core
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
                ctx.fill();
            }
        }

        // Explosion
        class Explosion {
            constructor(x, y, color) {
                this.sparks = [];
                const count = settings.sparkCount;
                const speed = settings.explosionSize / 10;

                for (let i = 0; i < count; i++) {
                    this.sparks.push(new Spark(x, y, color, speed));
                }

                // Multi-burst: add secondary smaller explosions
                if (settings.multiBurst && Math.random() > 0.5) {
                    setTimeout(() => {
                        const colors = getColors();
                        for (let i = 0; i < 3; i++) {
                            const offsetX = (Math.random() - 0.5) * 60;
                            const offsetY = (Math.random() - 0.5) * 60;
                            const newColor = colors[Math.floor(Math.random() * colors.length)];
                            for (let j = 0; j < count / 3; j++) {
                                this.sparks.push(new Spark(x + offsetX, y + offsetY, newColor, speed * 0.6));
                            }
                        }
                    }, 150);
                }
            }

            update() {
                this.sparks.forEach(s => s.update());
                this.sparks = this.sparks.filter(s => s.life > 0);
            }

            draw() {
                this.sparks.forEach(s => s.draw());
            }

            isDead() {
                return this.sparks.length === 0;
            }
        }

        // Shooting star
        class ShootingStar {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height * 0.3;
                const angle = Math.PI / 4 + (Math.random() - 0.5) * 0.5;
                const speed = 15 + Math.random() * 10;
                this.vx = Math.cos(angle) * speed;
                this.vy = Math.sin(angle) * speed;
                this.life = 1.0;
                this.trail = [];
                this.color = getRandomColor();
            }

            update() {
                this.trail.push({ x: this.x, y: this.y, life: 1.0 });
                if (this.trail.length > 20) this.trail.shift();
                this.trail.forEach(t => t.life -= 0.05);
                this.trail = this.trail.filter(t => t.life > 0);

                this.x += this.vx;
                this.y += this.vy;
                this.life -= 0.02;
            }

            draw() {
                const c = this.color;

                for (let i = 1; i < this.trail.length; i++) {
                    const t = this.trail[i];
                    const prev = this.trail[i - 1];
                    ctx.beginPath();
                    ctx.moveTo(prev.x, prev.y);
                    ctx.lineTo(t.x, t.y);
                    ctx.strokeStyle = `rgba(${c.r}, ${c.g}, ${c.b}, ${t.life * 0.8})`;
                    ctx.lineWidth = 2 * t.life;
                    ctx.stroke();
                }

                ctx.beginPath();
                ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, ${this.life})`;
                ctx.fill();
            }

            isDead() {
                return this.life <= 0 || this.x > canvas.width || this.y > canvas.height;
            }
        }

        let rockets = [];
        let explosions = [];
        let shootingStars = [];
        let launchTimer = 0;
        let shootingStarTimer = 0;

        // Draw initial background
        drawCloudySky();

        // Click to create explosions
        canvas.addEventListener('click', (e) => {
            explosions.push(new Explosion(e.clientX, e.clientY, getRandomColor()));
            explosions.push(new Explosion(e.clientX + (Math.random() - 0.5) * 80, e.clientY + (Math.random() - 0.5) * 80, getRandomColor()));
            explosions.push(new Explosion(e.clientX + (Math.random() - 0.5) * 80, e.clientY + (Math.random() - 0.5) * 80, getRandomColor()));
        });

        // Draw cloudy sky background
        function drawCloudySky() {
            // Dark green gradient sky
            const skyGradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            skyGradient.addColorStop(0, '#0a1a0a');
            skyGradient.addColorStop(0.3, '#0d2010');
            skyGradient.addColorStop(0.6, '#081508');
            skyGradient.addColorStop(1, '#040a04');
            ctx.fillStyle = skyGradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Add subtle clouds
            const time = Date.now() * 0.00005;
            ctx.globalAlpha = 0.08;
            for (let i = 0; i < 8; i++) {
                const x = ((i * 200 + time * 50) % (canvas.width + 400)) - 200;
                const y = 50 + i * 60 + Math.sin(time + i) * 20;
                const width = 200 + Math.sin(i) * 80;
                const height = 40 + Math.cos(i) * 20;

                const cloudGradient = ctx.createRadialGradient(x, y, 0, x, y, width);
                cloudGradient.addColorStop(0, '#1a3a1a');
                cloudGradient.addColorStop(0.5, '#0d200d');
                cloudGradient.addColorStop(1, 'transparent');
                ctx.fillStyle = cloudGradient;
                ctx.beginPath();
                ctx.ellipse(x, y, width, height, 0, 0, Math.PI * 2);
                ctx.fill();
            }
            ctx.globalAlpha = 1;
        }

        function animate() {
            // Fade with dark green
            ctx.fillStyle = 'rgba(4, 10, 4, 0.15)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Occasionally redraw clouds for depth
            if (Math.random() < 0.01) {
                drawCloudySky();
            }

            // Auto spawn explosions
            launchTimer++;
            if (launchTimer > (25 - settings.launchRate)) {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height * 0.7 + canvas.height * 0.1;
                explosions.push(new Explosion(x, y, getRandomColor()));
                if (Math.random() > 0.6) {
                    const x2 = Math.random() * canvas.width;
                    const y2 = Math.random() * canvas.height * 0.7 + canvas.height * 0.1;
                    explosions.push(new Explosion(x2, y2, getRandomColor()));
                }
                launchTimer = 0;
            }

            // Shooting stars
            if (settings.shootingStars) {
                shootingStarTimer++;
                if (shootingStarTimer > 60 && Math.random() < 0.02) {
                    shootingStars.push(new ShootingStar());
                    shootingStarTimer = 0;
                }
            }

            // Update and draw shooting stars
            shootingStars.forEach(star => {
                star.update();
                star.draw();
            });
            shootingStars = shootingStars.filter(star => !star.isDead());

            // Update and draw explosions
            explosions.forEach(exp => {
                exp.update();
                exp.draw();
            });
            explosions = explosions.filter(exp => !exp.isDead());

            requestAnimationFrame(animate);
        }

        animate();

        // Controls
        document.getElementById('launchRate').addEventListener('input', (e) => {
            settings.launchRate = parseInt(e.target.value);
        });

        document.getElementById('explosionSize').addEventListener('input', (e) => {
            settings.explosionSize = parseInt(e.target.value);
        });

        document.getElementById('sparkCount').addEventListener('input', (e) => {
            settings.sparkCount = parseInt(e.target.value);
        });

        document.getElementById('trailLength').addEventListener('input', (e) => {
            settings.trailLength = parseInt(e.target.value);
        });

        document.getElementById('shootingStars').addEventListener('change', (e) => {
            settings.shootingStars = e.target.checked;
        });

        document.getElementById('multiBurst').addEventListener('change', (e) => {
            settings.multiBurst = e.target.checked;
        });

        document.getElementById('sparkleTrail').addEventListener('change', (e) => {
            settings.sparkleTrail = e.target.checked;
        });

        // Theme buttons
        document.querySelectorAll('.theme-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                settings.colorTheme = btn.dataset.theme;
            });
        });
    </script>
</body>
</html>
